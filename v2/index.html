<html>
<head><title>Synapsis</title></head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="script.js"></script><script src="functions.js"></script><link rel="stylesheet" href="style.css">
<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML"></script>
<body>
	<div id="options">
		<div id="mode">Mode: view</div>
		<div id="instructions">
			<br>In view mode:
			<br>Q: view root node
			<br>$a\cdot b=\left\| a \right\| \left\| b \right\| \cos { \theta  }$
		</div>
	</div>
	<form>
		<img class="intLink" title="Print" onclick="printDoc();" src="icons/print.png" />
		<img class="intLink" title="Numbered list" onclick='formatDoc("insertorderedlist");' src='icons/numberedlist.gif' />
		<!-- <img class="intLink" title="Dotted list" onclick='formatDoc("insertunorderedlist");' src='icons/dottedlist.gif' /> -->
		<!-- <img class="intLink" title="Hyperlink" onclick="var sLnk=prompt('Write the URL here','http:\/\/');if(sLnk&&sLnk!=''&&sLnk!='http://'){formatDoc('createlink',sLnk)}" src="icons/hyperlink.gif" /> -->
	</form>
	<div id="container">
		<div id="textBox" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"></div>
	</div>
</body>
<script>

var mode="view", root, oroot=100, tbox=$("#textBox");

$(document).keydown(function(e){
	if(mode=="view"){
		switch(e.which){
			case 9:
			e.preventDefault();
			// loadPage(root);
			mode="edit";
			tbox.attr("contenteditable","true").css("-webkit-user-select","view");
			$("#mode").text("Mode: "+mode);
			break;
			case 81:
			loadPage(oroot);
			break;
			case 87:
			parseHeadings();
			break;
	    }
	}else{
		if([18,46].indexOf(e.which)!=-1||e.ctrlKey&&!([65,67,86,89,90].indexOf(e.which)!=-1)){e.preventDefault();}
		if(e.ctrlKey&&e.which==80){printDoc();}
		switch(e.which){
			case 9:
			e.preventDefault();
			// compareHTML();
			mode="view";
			tbox.attr("contenteditable","false").css("-webkit-user-select","none");
			$("#mode").text("Mode: "+mode);
			break;
			case 13:
			e.preventDefault();
			var range=window.getSelection().getRangeAt(0);
			var node=range.commonAncestorContainer;
			range.setStart(node,node.length);
			range.setEnd(node,node.length);
			formatDoc("insertHTML",'<div><br></div>');
			break;
			case 8:
			if(caretAtStart()){e.preventDefault();}
			break;
		}
	}
});

// document.addEventListener("paste", function(e){
// 	e.preventDefault();
// 	var text=e.clipboardData.getData("text/html");
// 	document.execCommand("insertHTML", false, text);
// });

loadPage(oroot);

</script>
</html>