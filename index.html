<html>
<head>
<title>Synapsis</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script src="script.js"></script>
<script src="functions.js"></script>
<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

	<div id="options">
		<div id="mode">
			Mode: view
		</div>
		<div id="instructions">
			<br>Keys:
			<br>Tab: tab between modes
			<br>B: toggle bubble display
			<br>
			<br>View Mode:
			<br>Q: view root node
			<br>
			<br>Edit Mode:
			<br>Q: delete current node
			<br>W: input relationship of node to node 0 (name)
			<br>E: New node with relationship "contains" to current node
			<br>A: Add node to selection
			<br>hotkeys for synapses to common nodes
			<br>Key2: New synapse between nodes
		</div>
	</div>

	<div id="container">
		<div id="inner_container">
			<div id="bubble_container">
				<svg viewbox=".5 .5 626 500">
					<defs>
						<marker id="arrow" markerWidth="10" markerHeight="10" refx="0" refy="2" orient="auto" markerUnits="strokeWidth">
							<path d="M0,0 L0,4 L5,2 z" />
						</marker>
					</defs>
				</svg>
			</div>
			<div id="heading_container">
			</div>
		</div>
	</div>

</body>
<script>
var svg=d3.select("svg");
svg.attr("width",sWidth).attr("height",sHeight);
var div=d3.select("#heading_container");

var mode="view";

var root;
var oroot=100;
var aDown=false;

query("get",oroot);

$(document).keydown(function(e){
	switch(mode){
		case "view":
			switch(e.which){
				case 81:
				query("get",oroot);
				break;
		    }
		break;
		case "edit":
			switch(e.which){
				case 81:
				if(root&&confirm("Are you sure?")){query("del",selected[0]);}
				break;
				case 87:
				var name=prompt("Enter a relation.");
				if(name){query("rel",selected[0],function(){
					if(selected.length==1){
						return 0;
					}else{
						return selected[1];
					}
				}
					,name);}
				break;
				case 69:
				query("new",root);
				break;
		    }
		break;
	}
	switch(e.which){
		case 9:
			e.preventDefault();
			if(mode=="view"){mode="edit";}else{mode="view";}
			$("#mode").text("Mode: "+mode);
		break;
		case 66:
			$("#bubble_container").toggle();
		break;
	}
});

$(document).on("keydown",function(e){if(e.keyCode=65){aDown=true}});
$(document).on("keyup",function(e){if(e.keyCode=65){aDown=false}});

</script>
</html>